@{
    ViewBag.Title = "Capture Image";
}

<h2>Capture Image</h2>

<button id="start-camera">Start Camera</button>
<video id="video" width="320" height="240" style="display: none;"></video>
<button id="capture" style="display: none;">Capture Image</button>
<canvas id="canvas" width="320" height="240" style="display: none;"></canvas>

<form id="imageForm" action="/Home/UploadImage" method="post" enctype="multipart/form-data">
    <input type="hidden" name="imageData" id="imageData" />
    <input type="submit" value="Upload Image" style="display: none;" id="uploadButton" />
</form>

<script>
    document.getElementById('capture').addEventListener('click', function() {
        document.getElementById('fileInput').click();
    });

    document.getElementById('fileInput').addEventListener('change', function() {
        if (this.files && this.files.length > 0) {
            const file = this.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                const img = document.getElementById('capturedImage');
                img.src = e.target.result;
                img.style.display = 'block';
            };

            reader.readAsDataURL(file);
            document.getElementById('uploadButton').style.display = 'block';
        }
    });

    document.getElementById('imageForm').addEventListener('submit', function(e) {
        const fileInput = document.getElementById('fileInput');
        if (!fileInput.files || fileInput.files.length === 0) {
            e.preventDefault();
            alert('Please capture an image first.');
        }
    });
</script>